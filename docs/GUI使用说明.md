# 课堂专注度检测系统 - GUI使用说明

## 📋 目录
- [系统简介](#系统简介)
- [安装步骤](#安装步骤)
- [启动方法](#启动方法)
- [界面说明](#界面说明)
- [使用流程](#使用流程)
- [常见问题](#常见问题)

---

## 🎯 系统简介

课堂专注度检测系统是一个基于深度学习的智能分析工具，可以自动检测课堂视频中学生的专注状态。

### 核心功能
- ✅ **自动人脸检测** - 使用YOLOv8-pose模型检测学生
- ✅ **行为分析** - 检测低头、闭眼、发呆等不专注行为
- ✅ **视频标注** - 生成带标注的视频文件
- ✅ **统计报告** - 生成详细的CSV报告和可视化图表
- ✅ **实时进度** - 显示处理进度和状态

### 检测行为类型
1. **长时间低头** - 持续低头超过3秒
2. **闭眼** - 持续闭眼超过2秒（打瞌睡）
3. **发呆** - 头部静止超过4秒
4. **短暂低头** - 瞬间低头
5. **侧身** - 肩膀倾斜角度过大
6. **手部异常** - 手部位置异常

---

## 🔧 安装步骤

### 1. 系统要求
- **操作系统**: macOS / Linux / Windows
- **Python版本**: 3.9 或更高
- **硬件要求**: 
  - 推荐使用NVIDIA GPU（支持CUDA）
  - 至少8GB内存
  - 至少5GB磁盘空间

### 2. 安装依赖

```bash
# 克隆或下载项目
cd classroom_attention

# 安装Python依赖
pip3 install -r requirements.txt
```

### 3. 下载模型文件

系统需要以下模型文件（应该已经在项目目录中）：
- `yolov8m-pose.pt` - YOLOv8姿态检测模型

---

## 🚀 启动方法

### 方法1: 使用启动脚本（推荐）

```bash
./run_gui.sh
```

### 方法2: 直接运行Python

```bash
python3 gui_main.py
```

---

## 🖥️ 界面说明

### 主界面布局

```
┌─────────────────────────────────────────────────────┐
│  课堂专注度检测系统 v2.0                              │
├──────────────┬──────────────────────────────────────┤
│              │                                      │
│  控制面板     │         检测结果                      │
│              │                                      │
│  - 视频选择   │  [统计图表] [详细报告]                │
│  - 参数设置   │                                      │
│  - 开始检测   │                                      │
│  - 进度显示   │                                      │
│  - 导出结果   │                                      │
│              │                                      │
└──────────────┴──────────────────────────────────────┘
```

### 控制面板组件

#### 1. 视频文件
- **功能**: 选择要分析的课堂视频
- **支持格式**: MP4, AVI, MOV, MKV

#### 2. 检测参数
- **专注度阈值** (0-100分)
  - 默认: 50分
  - 低于此分数判定为不专注
  - 建议范围: 40-60分

- **跳帧数** (0-10)
  - 默认: 2
  - 每处理1帧跳过N帧
  - 数值越大处理越快，但可能遗漏细节

- **最大帧数** (0=全部)
  - 默认: 0（处理全部）
  - 用于测试，只处理前N帧

#### 3. 控制按钮
- **▶️ 开始检测** - 启动视频分析
- **⏹️ 停止检测** - 中断当前处理

#### 4. 处理进度
- 进度条显示当前处理进度
- 状态标签显示当前操作

#### 5. 导出结果
- **📊 导出CSV报告** - 保存详细数据
- **🎬 打开标注视频** - 查看标注后的视频

### 结果展示面板

#### 标签页1: 📊 统计图表
- **左图**: 每个学生的不专注事件次数
- **右图**: 每个学生的总不专注时长

#### 标签页2: 📋 详细报告
- 每个学生的详细信息
- 不专注时间段
- 行为原因分析

---

## 📖 使用流程

### 步骤1: 选择视频
1. 点击 **"📁 选择视频文件"** 按钮
2. 在文件对话框中选择课堂视频
3. 确认视频路径显示正确

### 步骤2: 配置参数
1. 根据需要调整 **专注度阈值**
   - 阈值越高，判定越严格
   - 建议先使用默认值50分
2. 设置 **跳帧数**
   - 快速测试可设为5
   - 精确分析建议设为1-2
3. （可选）设置 **最大帧数** 用于测试

### 步骤3: 开始检测
1. 点击 **"▶️ 开始检测"** 按钮
2. 观察进度条和状态信息
3. 等待处理完成（会弹出提示框）

### 步骤4: 查看结果
1. 切换到 **"📊 统计图表"** 查看可视化数据
2. 切换到 **"📋 详细报告"** 查看文字报告
3. 点击 **"🎬 打开标注视频"** 观看标注结果

### 步骤5: 导出数据
1. 点击 **"📊 导出CSV报告"** 保存数据
2. 选择保存位置和文件名
3. CSV文件可用Excel或其他工具打开

---

## ❓ 常见问题

### Q1: 启动时提示缺少依赖包
**A**: 运行以下命令安装依赖：
```bash
pip3 install -r requirements.txt
```

### Q2: 处理速度很慢
**A**: 
- 检查是否启用了GPU加速
- 增加跳帧数（如设为5）
- 降低视频分辨率

### Q3: 检测不到学生
**A**:
- 确保视频中学生清晰可见
- 检查视频质量和光线条件
- 尝试降低置信度阈值

### Q4: 标注视频无法播放
**A**:
- 使用VLC播放器打开
- 检查视频编码格式
- 确认文件完整性

### Q5: 内存不足错误
**A**:
- 增加跳帧数
- 设置最大帧数限制
- 关闭其他占用内存的程序

---

## 📞 技术支持

如有问题，请查看：
- 项目README.md
- 控制台错误信息
- 系统日志文件

---

**版本**: v2.0  
**更新日期**: 2024年

